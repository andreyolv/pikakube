apiVersion: batch/v1
kind: Job
metadata:
  name: hive-initschema
  namespace: hive-metastore
spec:
  template:
    spec:
      containers:
        - name: hivemeta
          image:  cloudcheflabs/hivemetastore:v3.0.0 # mykidong/hivemetastore:v3.0.0 joshuarobinson/hivemetastore
          command: ["/opt/hive-metastore/bin/schematool"]
          args: 
          - "--verbose" 
          - "-initSchema"
          - "-dbType"
          - "mysql"
          - "-userName"
          - "root"
          - "-passWord"
          - "root"
          - "-url"
          - "jdbc:mysql://mysql.hive-metastore.svc.cluster.local:3306/metastore_db?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true"
      restartPolicy: Never
  backoffLimit: 4

  # https://stackoverflow.com/questions/2983248/com-mysql-jdbc-exceptions-jdbc4-communicationsexception-communications-link-fai