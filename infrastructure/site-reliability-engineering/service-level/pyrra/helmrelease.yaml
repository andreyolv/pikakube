apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: pyrra 
  namespace: pyrra 
spec:
  interval: 5m
  chart:
    spec:
      chart: pyrra 
      version: 0.14.3
      sourceRef:
        kind: HelmRepository
        name: rlex 
        namespace: flux-system
  values:
  # https://artifacthub.io/packages/helm/rlex/pyrra
  # https://github.com/rlex/helm-charts/blob/master/charts/pyrra/values.yaml
    prometheusUrl: http://prometheus-kube-prometheus-prometheus.prometheus.svc.cluster.local:9090
    ingress:
      enabled: true
      annotations:
        forecastle.stakater.com/expose: "true"
        #forecastle.stakater.com/icon: ""
        forecastle.stakater.com/appName: "Pyrra"
        forecastle.stakater.com/group: "Observability"
      hosts:
        - host: pyrra.127.0.0.1.nip.io
          paths:
            - path: /
              pathType: Prefix
      tls:
      - secretName: mkcert-tls-secret
        hosts:
        - pyrra.127.0.0.1.nip.io
    serviceMonitor:
      enabled: true
    serviceMonitorOperator:
      enabled: true
    prometheusRule:
      enabled: true
