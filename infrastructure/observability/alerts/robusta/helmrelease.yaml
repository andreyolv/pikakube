apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: robusta
  namespace: robusta
spec:
  interval: 5m
  chart:
    spec:
      chart: robusta
      version: 0.10.26
      sourceRef:
        kind: HelmRepository
        name: robusta
        namespace: flux-system
  values:
  # https://github.com/robusta-dev/robusta/blob/master/helm/robusta/values.yaml
    clusterName: "k8s-platform"
    enableServiceMonitors: false
    monitorHelmReleases: false
    # globalConfig:
    #   grafana_url:
    #   prometheus_url: http://PROMETHEUS_SERVICE_NAME.NAMESPACE.svc.cluster.local:9090
    #   account_id:
    enablePlatformPlaybooks: true
    sinksConfig:
    - telegram_sink:
        name: telegram_sink
        bot_token: xxxxxxxxxxx
        chat_id: xxxxxxxxxxxx
    - robusta_sink:
        name: robusta_ui_sink
        # generated with `robusta gen-config`
        # python3 -m pip install -U robusta-cli --no-cache
        # robusta gen-config
        # UI https://platform.robusta.dev/
        token: xxxxxxxxxxxxxxx
        ttl_hours: 336 # 14 days